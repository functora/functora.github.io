use serde::{Deserialize, Serialize};

#[derive(
    Debug,
    Clone,
    Copy,
    PartialEq,
    Eq,
    Serialize,
    Deserialize,
)]
pub enum Language {
    English,
    Spanish,
    Russian,
}

impl Language {
    pub fn from_code(code: &str) -> Self {
        match code.split('-').next().unwrap_or("en") {
            "es" => Language::Spanish,
            "ru" => Language::Russian,
            _ => Language::English,
        }
    }
}

#[derive(Clone)]
pub struct Translations {
    pub note_placeholder: &'static str,
    pub no_encryption: &'static str,
    pub password_encryption: &'static str,
    pub cipher: &'static str,
    pub password: &'static str,
    pub password_placeholder: &'static str,
    pub generate_button: &'static str,
    pub share_title: &'static str,
    pub click_to_copy: &'static str,
    pub qr_code: &'static str,
    pub encrypted_note: &'static str,
    pub encrypted_note_desc: &'static str,
    pub decrypt_button: &'static str,
    pub your_note_title: &'static str,
    pub error_title: &'static str,
    pub loading: &'static str,
    pub password_required: &'static str,
    pub encryption_failed: &'static str,
    pub qr_generation_failed: &'static str,
    pub url_generation_failed: &'static str,
    pub failed_to_parse_url: &'static str,
    pub no_note_in_url: &'static str,
    pub decryption_failed: &'static str,
    pub invalid_utf8: &'static str,
    pub crypto_error: &'static str,
    pub encoding_error: &'static str,
    pub utf8_error: &'static str,
    pub invalid_url_error: &'static str,
    pub missing_salt_error: &'static str,
    pub invalid_encryption_mode_error: &'static str,
}

pub fn get_translations(lang: Language) -> Translations {
    match lang {
        Language::English => Translations {
            note_placeholder: "Enter your note here...",
            no_encryption: "No encryption (plaintext)",
            password_encryption: "Password encryption",
            cipher: "Cipher",
            password: "Password",
            password_placeholder: "Enter password",
            generate_button: "Generate Shareable Link",
            share_title: "Share Your Note",
            click_to_copy: "Click to copy",
            qr_code: "QR Code",
            encrypted_note: "ðŸ”’ Encrypted Note",
            encrypted_note_desc: "This note is encrypted. Enter the password to decrypt it.",
            decrypt_button: "Decrypt Note",
            your_note_title: "Your Note",
            error_title: "Error",
            loading: "Loading note...",
            password_required: "Password is required for encryption",
            encryption_failed: "Encryption failed",
            qr_generation_failed: "QR generation failed",
            url_generation_failed: "URL generation failed",
            failed_to_parse_url: "Failed to parse URL",
            no_note_in_url: "No note found in URL",
            decryption_failed: "Decryption failed",
            invalid_utf8: "Decrypted data is not valid UTF-8",
            crypto_error: "Cryptography error",
            encoding_error: "Encoding error",
            utf8_error: "Text encoding error",
            invalid_url_error: "Invalid URL format",
            missing_salt_error: "Missing encryption salt",
            invalid_encryption_mode_error: "Invalid encryption mode",
        },
        Language::Spanish => Translations {
            note_placeholder: "Escribe tu nota aquÃ­...",
            no_encryption: "Sin cifrado (texto plano)",
            password_encryption: "Cifrado con contraseÃ±a",
            cipher: "Cifrado",
            password: "ContraseÃ±a",
            password_placeholder: "Ingresa contraseÃ±a",
            generate_button: "Generar Enlace Compartible",
            share_title: "Comparte Tu Nota",
            click_to_copy: "Haz clic para copiar",
            qr_code: "CÃ³digo QR",
            encrypted_note: "ðŸ”’ Nota Cifrada",
            encrypted_note_desc: "Esta nota estÃ¡ cifrada. Ingresa la contraseÃ±a para descifrarla.",
            decrypt_button: "Descifrar Nota",
            your_note_title: "Tu Nota",
            error_title: "Error",
            loading: "Cargando nota...",
            password_required: "Se requiere contraseÃ±a para el cifrado",
            encryption_failed: "FallÃ³ el cifrado",
            qr_generation_failed: "FallÃ³ la generaciÃ³n del cÃ³digo QR",
            url_generation_failed: "FallÃ³ la generaciÃ³n de URL",
            failed_to_parse_url: "No se pudo analizar la URL",
            no_note_in_url: "No se encontrÃ³ nota en la URL",
            decryption_failed: "FallÃ³ el descifrado",
            invalid_utf8: "Los datos descifrados no son UTF-8 vÃ¡lidos",
            crypto_error: "Error criptogrÃ¡fico",
            encoding_error: "Error de codificaciÃ³n",
            utf8_error: "Error de codificaciÃ³n de texto",
            invalid_url_error: "Formato de URL invÃ¡lido",
            missing_salt_error: "Falta sal de cifrado",
            invalid_encryption_mode_error: "Modo de cifrado invÃ¡lido",
        },
        Language::Russian => Translations {
            note_placeholder: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÑƒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ Ð·Ð´ÐµÑÑŒ...",
            no_encryption: "Ð‘ÐµÐ· ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ (Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚)",
            password_encryption: "Ð¨Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¼",
            cipher: "Ð¨Ð¸Ñ„Ñ€",
            password: "ÐŸÐ°Ñ€Ð¾Ð»ÑŒ",
            password_placeholder: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
            generate_button: "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¡ÑÑ‹Ð»ÐºÑƒ Ð´Ð»Ñ ÐžÐ±Ð¼ÐµÐ½Ð°",
            share_title: "ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¾Ð¹",
            click_to_copy: "ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ",
            qr_code: "QR-ÐºÐ¾Ð´",
            encrypted_note: "ðŸ”’ Ð—Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°",
            encrypted_note_desc: "Ð­Ñ‚Ð° Ð·Ð°Ð¼ÐµÑ‚ÐºÐ° Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð°. Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸.",
            decrypt_button: "Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð—Ð°Ð¼ÐµÑ‚ÐºÑƒ",
            your_note_title: "Ð’Ð°ÑˆÐ° Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°",
            error_title: "ÐžÑˆÐ¸Ð±ÐºÐ°",
            loading: "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð·Ð°Ð¼ÐµÑ‚ÐºÐ¸...",
            password_required: "Ð”Ð»Ñ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
            encryption_failed: "ÐžÑˆÐ¸Ð±ÐºÐ° ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ",
            qr_generation_failed: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ QR-ÐºÐ¾Ð´Ð°",
            url_generation_failed: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ URL",
            failed_to_parse_url: "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ñ€Ð°Ð·Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ URL",
            no_note_in_url: "Ð—Ð°Ð¼ÐµÑ‚ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð² URL",
            decryption_failed: "ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸",
            invalid_utf8: "Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ðµ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¼ UTF-8",
            crypto_error: "ÐšÑ€Ð¸Ð¿Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°",
            encoding_error: "ÐžÑˆÐ¸Ð±ÐºÐ° ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ",
            utf8_error: "ÐžÑˆÐ¸Ð±ÐºÐ° ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ñ‚ÐµÐºÑÑ‚Ð°",
            invalid_url_error: "ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ URL",
            missing_salt_error: "ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ ÑÐ¾Ð»ÑŒ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ",
            invalid_encryption_mode_error: "ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ",
        },
    }
}

pub fn detect_browser_language() -> Language {
    web_sys::window()
        .and_then(|w| w.navigator().language())
        .map(|lang| Language::from_code(&lang))
        .unwrap_or(Language::English)
}
