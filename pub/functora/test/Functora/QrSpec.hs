module Functora.QrSpec (spec) where

import qualified Codec.QRCode as QR
import Functora.Prelude
import Functora.Qr
import Test.Hspec

sample :: Maybe QR.QRImage
sample =
  QR.encodeAutomatic
    (QR.defaultQRCodeOptions QR.L)
    QR.Iso8859_1OrUtf8WithoutECI
    ("21FA" :: Text)

spec :: Spec
spec = do
  it "qrToBmpDataUrlTL/0/0" $ do
    qrToBmpDataUrlTL @Text 0 0 <$> sample
      `shouldBe` Just "data:image/bmp;base64,Qk0aBwAAAAAAADYAAAAoAAAAFQAAABUAAAABACAAAAAAAOQGAAASCwAAEgsAAAAAAAAAAAAAAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////////////////////AAAA////////////AAAA////////////AAAA//////8AAAD///////////////////////////8AAAD/AAAA//////8AAAD/AAAA/wAAAP//////AAAA////////////AAAA/wAAAP////////////////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD/AAAA//////8AAAD/AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD/AAAA//////8AAAD/AAAA/wAAAP//////AAAA////////////AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD/AAAA////////////////////////////AAAA////////////AAAA//////8AAAD///////////8AAAD///////////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD//////wAAAP//////AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/////////////////////////////////////////////////AAAA////////////AAAA//////////////////////////////////////////////////////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD///////////8AAAD/AAAA/wAAAP////////////////8AAAD///////////8AAAD///////////8AAAD/AAAA/wAAAP///////////wAAAP////////////////8AAAD/AAAA//////8AAAD///////////////////////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////AAAA/////////////////////////////////wAAAP///////////wAAAP8AAAD/AAAA//////////////////////8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA//////8AAAD/////////////////////////////////////////////////AAAA////////////AAAA/wAAAP8AAAD/AAAA/////////////////wAAAP////////////////8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD///////////////////////////////////////////8AAAD//////wAAAP///////////wAAAP//////AAAA//////8AAAD/AAAA/wAAAP//////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////////////////////8AAAD///////////8AAAD/AAAA//////////////////////8AAAD/AAAA////////////////////////////AAAA//////8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD//////wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP8AAAD/////////////////AAAA////////////AAAA//////8AAAD/AAAA//////8AAAD/AAAA/wAAAP//////AAAA////////////AAAA////////////AAAA//////8AAAD/////////////////AAAA/wAAAP//////AAAA//////8AAAD/AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP//////AAAA/////////////////wAAAP////////////////8AAAD/AAAA////////////////////////////AAAA////////////////////////////AAAA/wAAAP8AAAD/////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA////////////AAAA/////////////////////////////////wAAAP//////AAAA//////8AAAD/"
  it "qrToBmpDataUrlTL/1/0" $ do
    qrToBmpDataUrlTL @Text 1 0 <$> sample
      `shouldBe` Just "data:image/bmp;base64,Qk16CAAAAAAAADYAAAAoAAAAFwAAABcAAAABACAAAAAAAEQIAAASCwAAEgsAAAAAAAAAAAAA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/AAAA/wAAAP8AAAD///////////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////8AAAD///////////////////////////8AAAD///////////8AAAD///////////8AAAD//////wAAAP///////////////////////////wAAAP///////////wAAAP//////AAAA/wAAAP8AAAD//////wAAAP///////////wAAAP8AAAD/////////////////AAAA//////8AAAD/AAAA/wAAAP//////AAAA////////////AAAA//////8AAAD/AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD///////////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD///////////8AAAD/AAAA//////8AAAD//////wAAAP//////AAAA/wAAAP8AAAD//////wAAAP///////////wAAAP///////////////////////////wAAAP///////////wAAAP//////AAAA////////////AAAA////////////////////////////AAAA////////////AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD//////wAAAP//////AAAA//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD///////////////////////////////////////////////////////////8AAAD///////////8AAAD/////////////////////////////////////////////////////////////////AAAA//////8AAAD/AAAA/wAAAP//////AAAA////////////AAAA/wAAAP8AAAD/////////////////AAAA////////////AAAA//////////////////////8AAAD/AAAA/wAAAP///////////wAAAP////////////////8AAAD/AAAA//////8AAAD///////////////////////////8AAAD///////////8AAAD/AAAA/wAAAP8AAAD/AAAA//////8AAAD/////////////////////////////////AAAA////////////AAAA/wAAAP8AAAD/////////////////////////////////AAAA/wAAAP8AAAD/AAAA////////////AAAA/wAAAP//////AAAA////////////////////////////////////////////////////////////AAAA////////////AAAA/wAAAP8AAAD/AAAA/////////////////wAAAP////////////////8AAAD//////wAAAP8AAAD/AAAA/wAAAP8AAAD//////////////////////////////////////////////////////wAAAP//////AAAA////////////AAAA//////8AAAD//////wAAAP8AAAD/AAAA/////////////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//////////////////////AAAA////////////AAAA/wAAAP//////////////////////AAAA////////////AAAA////////////////////////////AAAA//////8AAAD/AAAA////////////////////////////AAAA/wAAAP8AAAD//////wAAAP8AAAD///////////8AAAD//////wAAAP8AAAD/AAAA//////8AAAD//////wAAAP//////AAAA/wAAAP////////////////8AAAD///////////8AAAD//////wAAAP///////////wAAAP//////AAAA/wAAAP8AAAD//////wAAAP///////////wAAAP///////////wAAAP//////AAAA/////////////////wAAAP8AAAD/////////////////AAAA//////8AAAD/AAAA/wAAAP//////AAAA//////8AAAD//////wAAAP//////AAAA/////////////////wAAAP////////////////8AAAD///////////8AAAD///////////////////////////8AAAD///////////////////////////8AAAD/AAAA/wAAAP////////////////8AAAD/AAAA/wAAAP///////////wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP///////////wAAAP////////////////////////////////8AAAD//////wAAAP//////AAAA/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////w=="
