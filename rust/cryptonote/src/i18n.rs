use serde::{Deserialize, Serialize};

#[derive(
    Debug,
    Clone,
    Copy,
    PartialEq,
    Eq,
    Serialize,
    Deserialize,
)]
pub enum Language {
    English,
    Spanish,
    Russian,
}

impl Language {
    pub fn from_code(code: &str) -> Self {
        match code.split('-').next().unwrap_or("en") {
            "es" => Language::Spanish,
            "ru" => Language::Russian,
            _ => Language::English,
        }
    }
}

#[derive(Clone)]
pub struct Translations {
    pub note: &'static str,
    pub note_placeholder: &'static str,
    pub mode: &'static str,
    pub no_encryption: &'static str,
    pub password_encryption: &'static str,
    pub algorithm: &'static str,
    pub password: &'static str,
    pub password_placeholder: &'static str,
    pub generate_button: &'static str,
    pub share_title: &'static str,
    pub click_to_copy: &'static str,
    pub encrypted_note: &'static str,
    pub encrypted_note_desc: &'static str,
    pub decrypt_button: &'static str,
    pub your_note_title: &'static str,
    pub error_title: &'static str,
    pub loading: &'static str,
    pub create_new_note: &'static str,
    pub edit_note: &'static str,
    pub password_required: &'static str,
    pub no_note_in_url: &'static str,
    pub invalid_utf8: &'static str,
    pub cipher_error: &'static str,
    pub getrandom_error: &'static str,
    pub base64_error: &'static str,
    pub json_error: &'static str,
    pub utf8_error: &'static str,
    pub qr_error: &'static str,
    pub encrypt_error: &'static str,
    pub decrypt_error: &'static str,
    pub url_error: &'static str,
    pub home: &'static str,
}

pub fn get_translations(lang: Language) -> Translations {
    match lang {
        Language::English => Translations {
            note: "Note",
            note_placeholder: "Enter your note here...",
            mode: "Mode",
            no_encryption: "No encryption (plaintext)",
            password_encryption: "Password encryption",
            algorithm: "Algorithm",
            password: "Password",
            password_placeholder: "Enter password",
            generate_button: "Generate Shareable Link",
            share_title: "Share Your Note",
            click_to_copy: "Click to copy",
            encrypted_note: "ðŸ”’ Encrypted Note",
            encrypted_note_desc: "This note is encrypted. Enter the password to decrypt it.",
            decrypt_button: "Decrypt Note",
            your_note_title: "Your Note",
            error_title: "Error",
            loading: "Loading note...",
            create_new_note: "Create a new note",
            edit_note: "Edit Note",
            password_required: "Password is required for encryption",
            no_note_in_url: "No note found in URL",
            invalid_utf8: "Decrypted data is not valid UTF-8",
            cipher_error: "Cipher initialization error",
            getrandom_error: "Random number generation error",
            base64_error: "Base64 decoding error",
            json_error: "JSON parsing error",
            utf8_error: "Text encoding error",
            qr_error: "QR code generation error",
            encrypt_error: "Encryption failed",
            decrypt_error: "Decryption failed",
            url_error: "Invalid URL format",
            home: "Home",
        },
        Language::Spanish => Translations {
            note: "Nota",
            note_placeholder: "Escribe tu nota aquÃ­...",
            mode: "Modo",
            no_encryption: "Sin cifrado (texto plano)",
            password_encryption: "Cifrado con contraseÃ±a",
            algorithm: "Algoritmo",
            password: "ContraseÃ±a",
            password_placeholder: "Ingresa contraseÃ±a",
            generate_button: "Generar Enlace Compartible",
            share_title: "Comparte Tu Nota",
            click_to_copy: "Haz clic para copiar",
            encrypted_note: "ðŸ”’ Nota Cifrada",
            encrypted_note_desc: "Esta nota estÃ¡ cifrada. Ingresa la contraseÃ±a para descifrarla.",
            decrypt_button: "Descifrar Nota",
            your_note_title: "Tu Nota",
            error_title: "Error",
            loading: "Cargando nota...",
            create_new_note: "Crear una nueva nota",
            edit_note: "Editar Nota",
            password_required: "Se requiere contraseÃ±a para el cifrado",
            no_note_in_url: "No se encontrÃ³ nota en la URL",
            invalid_utf8: "Los datos descifrados no son UTF-8 vÃ¡lidos",
            cipher_error: "Error de inicializaciÃ³n de cifrado",
            getrandom_error: "Error de generaciÃ³n de nÃºmeros aleatorios",
            base64_error: "Error de decodificaciÃ³n Base64",
            json_error: "Error de anÃ¡lisis JSON",
            utf8_error: "Error de codificaciÃ³n de texto",
            qr_error: "Error de generaciÃ³n de cÃ³digo QR",
            encrypt_error: "FallÃ³ el cifrado",
            decrypt_error: "FallÃ³ el descifrado",
            url_error: "Formato de URL invÃ¡lido",
            home: "Inicio",
        },
        Language::Russian => Translations {
            note: "Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°",
            note_placeholder: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÑƒ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ Ð·Ð´ÐµÑÑŒ...",
            mode: "Ð ÐµÐ¶Ð¸Ð¼",
            no_encryption: "Ð‘ÐµÐ· ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ (Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚)",
            password_encryption: "Ð¨Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¼",
            algorithm: "ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼",
            password: "ÐŸÐ°Ñ€Ð¾Ð»ÑŒ",
            password_placeholder: "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
            generate_button: "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¡ÑÑ‹Ð»ÐºÑƒ Ð´Ð»Ñ ÐžÐ±Ð¼ÐµÐ½Ð°",
            share_title: "ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ¾Ð¹",
            click_to_copy: "ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ",
            encrypted_note: "ðŸ”’ Ð—Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°",
            encrypted_note_desc: "Ð­Ñ‚Ð° Ð·Ð°Ð¼ÐµÑ‚ÐºÐ° Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð°. Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸.",
            decrypt_button: "Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð—Ð°Ð¼ÐµÑ‚ÐºÑƒ",
            your_note_title: "Ð’Ð°ÑˆÐ° Ð—Ð°Ð¼ÐµÑ‚ÐºÐ°",
            error_title: "ÐžÑˆÐ¸Ð±ÐºÐ°",
            loading: "Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð·Ð°Ð¼ÐµÑ‚ÐºÐ¸...",
            create_new_note: "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ",
            edit_note: "Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð—Ð°Ð¼ÐµÑ‚ÐºÑƒ",
            password_required: "Ð”Ð»Ñ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ",
            no_note_in_url: "Ð—Ð°Ð¼ÐµÑ‚ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð² URL",
            invalid_utf8: "Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ðµ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ð¼ UTF-8",
            cipher_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÑˆÐ¸Ñ„Ñ€Ð°",
            getrandom_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ»",
            base64_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð´ÐµÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Base64",
            json_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€Ð°Ð·Ð±Ð¾Ñ€Ð° JSON",
            utf8_error: "ÐžÑˆÐ¸Ð±ÐºÐ° ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ñ‚ÐµÐºÑÑ‚Ð°",
            qr_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ QR-ÐºÐ¾Ð´Ð°",
            encrypt_error: "ÐžÑˆÐ¸Ð±ÐºÐ° ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ",
            decrypt_error: "ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸",
            url_error: "ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ URL",
            home: "Ð“Ð»Ð°Ð²Ð½Ð°Ñ",
        },
    }
}

pub fn detect_browser_language() -> Language {
    web_sys::window()
        .and_then(|w| w.navigator().language())
        .map(|lang| Language::from_code(&lang))
        .unwrap_or(Language::English)
}
